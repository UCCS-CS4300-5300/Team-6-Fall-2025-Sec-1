{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Check Your Email | Wanderly</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="{% static 'user_auth/styles.css' %}">
        <style>
            .countdown-pill {
                display: inline-flex;
                align-items: center;
                gap: 0.85rem;
                margin: 1.75rem auto;
                padding: 0.65rem 1.6rem;
                border-radius: 999px;
                border: 1px solid rgba(13, 110, 253, 0.45);
                background: linear-gradient(135deg, rgba(13, 110, 253, 0.15), rgba(0, 98, 204, 0.35));
                color: #052c65;
                letter-spacing: 0.12em;
                box-shadow: 0 10px 25px rgba(13, 110, 253, 0.15);
            }
            .countdown-pill span {
                font-family: "Space Mono", "Courier New", monospace;
                font-size: 1.55rem;
                letter-spacing: 0.12em;
                color: #fff;
                padding: 0.15rem 0.65rem;
                border-radius: 0.5rem;
                background: rgba(255, 255, 255, 0.35);
            }
        </style>
    </head>
    <body class="auth-page auth-forgot">
        <section class="info-section min-vh-100 d-flex align-items-center">
            <div class="container py-5">
                <div class="row justify-content-center">
                    <div class="col-lg-6">
                        <div class="card card-hover border-0 rounded-4 p-4 p-md-5 shadow text-center">
                            <div class="mb-4">
                                <h1 class="display-6 fw-bold mb-2">Check your inbox</h1>
                                <p class="text-secondary mb-0">
                                    {% if masked_email %}
                                        We've emailed instructions to <strong>{{ masked_email }}</strong>. It may take a couple of minutes to arrive.
                                    {% else %}
                                        We've emailed instructions to reset your password. It may take a couple of minutes to arrive.
                                    {% endif %}
                                </p>
                            </div>
                            <div class="countdown-pill text-uppercase small fw-semibold">
                                Link expires in
                                <span id="reset-countdown" data-seconds="{{ countdown_seconds|default:300 }}">05:00</span>
                            </div>
                            <div class="d-grid gap-3">
                                {% if resend_enabled %}
                                    <form method="post" action="{% url 'forgot_password_resend' %}">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-primary btn-lg w-100">
                                            Didn't get it? Resend email
                                        </button>
                                    </form>
                                {% else %}
                                    <a class="btn btn-outline-secondary btn-lg" href="{% url 'forgot_password_request' %}">
                                        Didn't get it? Try again
                                    </a>
                                {% endif %}
                            </div>
                            <div class="text-center mt-4">
                                <a class="text-decoration-none fw-semibold" href="{% url 'sign_in' %}">Return to login</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            (function () {
                const countdownEl = document.getElementById("reset-countdown");
                if (!countdownEl) {
                    return;
                }
                let remaining = parseInt(countdownEl.dataset.seconds || "300", 10);

                function format(seconds) {
                    const minutes = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    return `${String(minutes).padStart(2, "0")}:${String(secs).padStart(2, "0")}`;
                }

                countdownEl.textContent = format(remaining);

                setInterval(() => {
                    remaining = Math.max(0, remaining - 1);
                    countdownEl.textContent = format(remaining);
                }, 1000);
            })();
        </script>
    </body>
</html>
